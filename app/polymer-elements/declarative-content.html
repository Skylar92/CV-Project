<dom-module id="declarative-content">

    <style>

        :host {
            @apply(--layout-horizontal);
            @apply(--layout-center-center);
            @apply(--layout-fit);
        }

        .text {
            color: white;
        }

        #back {
            margin-top: 1%;
            margin-bottom: 1%;
            margin-left: 1%;
        }

        #title {
            font-size: 36px;
            font-family: monospace;
            text-shadow: 0 1px 0;
        }

        #previous, #next {
            width: 50%;
            color: white;
            background-color: #3f51b5;
        }

    </style>

    <template>

        <div id="content-view" class="fullbleed layout vertical">
            <div id="header">
                <span class="start" id="back">
                    <paper-fab icon="home" title="arrow-forward" tabindex="0"></paper-fab>
                </span>
                <!-- todo title display-->
                <!--<span id="title" class="center"></span>-->

            </div>

            <neon-animated-pages id="views"
                                 class="flex"
                                 selected="[[selected]]"
                                 entry-animation="[[entryAnimation]]"
                                 exit-animation="[[exitAnimation]]">
                <template is="dom-repeat" items="{{dataView}}">
                    <neon-animatable id="{{item.id}}">
                        <div class="text">{{item.content}}</div>
                    </neon-animatable>
                </template>
            </neon-animated-pages>
            <footer class="horizontal layout">
                    <paper-button on-click="_onPrevClick" tabindex="0" raised class="colorful custom flex" id="previous">
                        <iron-icon icon="arrow-back"></iron-icon>
                        Previous
                    </paper-button>
                    <paper-button on-click="_onNextClick" tabindex="0" raised class="colorful custom flex" id="next">
                        Next
                        <iron-icon icon="arrow-forward"></iron-icon>
                    </paper-button>
            </footer>
        </div>

    </template>

</dom-module>


<script>

    DeclarativeContent = Polymer({

        is: 'declarative-content',

        /**
         * @param data - JSON object which comprises content and background color to each content.
         */
        factoryImpl: function (data, headerColor, title) {
            this.title = title;
            this.headerColor = headerColor;
            this.dataView = data;
            this.dataSize = data.length - 1;
            this.selected = 0;
        },

        attached: function () {
            //init set color
            this.$.views.style.backgroundColor = this.dataView[0].color;
            //set header panel color
            this.$.header.style.backgroundColor = this.headerColor;
            //set title
            this.$.title.innerText = this.title;
        },

        _onPrevClick: function () {
            var tempSelect = this.selected === 0 ? this.dataSize : (this.selected - 1);
            this.changeColorsContent(tempSelect);
            this.entryAnimation = 'slide-from-left-animation';
            this.exitAnimation = 'slide-right-animation';
            this.selected = tempSelect;
        },

        _onNextClick: function () {
            var tempSelect = this.selected === 0 ? this.dataSize : (this.selected - 1);
            this.changeColorsContent(tempSelect);
            this.entryAnimation = 'slide-from-right-animation';
            this.exitAnimation = 'slide-left-animation';
            this.selected = tempSelect;
        },

        /**
         * Set next color to neon-animatable
         * @param select - current number
         */
        changeColorsContent: function (select) {
            var styleContent = document.getElementById(this.dataView[select].id).style;
            if(styleContent == null || styleContent == undefined)
                throw DOMException('Content not yet prepared for modify styles');

            var color = this.dataView[select].color;
            if(color == null || color == undefined)
                color = 'white';

            styleContent.backgroundColor = color;
        }

    })


</script>