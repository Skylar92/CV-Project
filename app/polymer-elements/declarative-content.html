<dom-module id="declarative-content">

    <style is="custom">

        :host {
            @apply(--layout-horizontal);
            @apply(--layout-center-center);
            @apply(--layout-fit);
        }

        #header {
            height: 10%;
        }

        #views {
            height: 80%;
        }

        #footer {
            height: 10%;
        }

        #content-text {
            color: white;
        }


    </style>

    <template>

        <div id="content-view">
            <div class="flex self-start" id="header">
                <button-back></button-back>
            </div>

            <neon-animated-pages id="views"
                                 class="flex self-center"
                                 selected="[[selected]]"
                                 entry-animation="[[entryAnimation]]"
                                 exit-animation="[[exitAnimation]]">
                <template is="dom-repeat" items="{{dataView}}">
                    <neon-animatable id="{{item.id}}">
                        <div class="flex self-center" id="content-text">{{item.content}}</div>
                    </neon-animatable>
                </template>
            </neon-animated-pages>

            <div class="toolbar flex self-end" style="text-align: center" id="footer">
                <button-back on-click="_onPrevClick"></button-back>
                <button-back on-click="_onNextClick"></button-back>
            </div>
        </div>

    </template>

</dom-module>


<script>

    DeclarativeContent = Polymer({
        is: 'declarative-content',

        /**
         * @param data - JSON object which comprises content and background color to each content.
         */
        factoryImpl: function (data) {
            this.dataView = data;
            this.dataSize = data.length - 1;
            this.selected = 0;
        },

        attached: function() {
            //Modify background color after view content
            this.changeColorsContent(this.selected);
            //apply to each neon-animatable background color
            this.addColorToEachNeonAnimatable();
        },

        _onPrevClick: function () {
            this.entryAnimation = 'slide-from-left-animation';
            this.exitAnimation = 'slide-right-animation';
            this.selected = this.selected === 0 ? this.dataSize : (this.selected - 1);
        },

        _onNextClick: function () {
            this.entryAnimation = 'slide-from-right-animation';
            this.exitAnimation = 'slide-left-animation';
            this.selected = this.selected === this.dataSize ? 0 : (this.selected + 1);
        },

        changeColorsContent: function (select) {
            var styleContent = document.getElementById('content-view').style;
            if(styleContent == null || styleContent == undefined)
                throw DOMException('Content not yet prepared for modify styles');

            var color = this.dataView[select].color;
            if(color == null || color == undefined)
                color = 'white';

            styleContent.backgroundColor = color;
        },

        //todo this method
        addColorToEachNeonAnimatable : function() {
//            var style = document.createElement('style');
//            style.type = 'text/css';
//            var cssRules = '';
//            for(var i = 0; i < this.dataView.length; i++) {
//                //create dynamic CSS class
//                var colorContent = '--paper-' + this.dataView[i].id + "\n";
//                cssRules = cssRules + colorContent + '#'+ this.dataView[i].id + ' { background: var('+ colorContent + '); }\n';
//            }
//            console.log(cssRules);
//
//            var styleContent = document.querySelector('style[is="custom"]');
//            console.log(styleContent);
//            styleContent.appendChild(style);
        }
    })


</script>