<!--This content now not be used, because animation in Polymer not work very well in complex construction-->

<dom-module id="declarative-content">

    <style>

        :host {
            @apply(--layout-horizontal);
            @apply(--layout-center-center);
            @apply(--layout-fit);
        }

        .text {
            color: white;
        }

        #back {
            margin-top: 1%;
            margin-bottom: 1%;
            margin-left: 1%;
        }

        #previous, #next {
            width: 50%;
            color: white;
            background-color: #3f51b5;
        }

    </style>

    <template>

        <div id="content-view" class="fullbleed layout vertical">
            <!-- header -->
            <div id="header">
                <span class="start" id="back">
                    <paper-fab icon="home" title="arrow-forward" tabindex="0" on-click="_home"></paper-fab>
                </span>
                <!-- todo title display-->
                <!--<span id="title" class="center"></span>-->
            </div>

            <!-- content -->
            <neon-animated-pages id="views"
                                 class="flex"
                                 selected="[[selected]]"
                                 entry-animation="[[entryAnimation]]"
                                 exit-animation="[[exitAnimation]]">
                <template is="dom-repeat" items="{{dataView}}">
                    <neon-animatable id="{{item.id}}">
                        <inner-content data="{{item.content}}"></inner-content>
                    </neon-animatable>
                </template>
            </neon-animated-pages>

            <!-- footer -->
            <footer class="horizontal layout" id="footer">
                <paper-button on-click="_onPrevClick" tabindex="0" raised class="colorful custom flex" id="previous">
                    <iron-icon icon="arrow-back"></iron-icon>
                    Previous
                </paper-button>
                <paper-button on-click="_onNextClick" tabindex="0" raised class="colorful custom flex" id="next">
                    Next
                    <iron-icon icon="arrow-forward"></iron-icon>
                </paper-button>
            </footer>
        </div>

    </template>

</dom-module>


<script>

    DeclarativeContent = Polymer({

        is: 'declarative-content',

        /**
         * @param data - JSON object which comprises content and background color to each content.
         * @param headerColor
         * @param title
         */
        factoryImpl: function (data, headerColor, title) {
            this.title = title;
            this.headerColor = headerColor;
            this.dataView = data;
            this.dataSize = data.length - 1;
            this.selected = 0;
        },

        attached: function () {
            //init set color
            this.$.views.style.backgroundColor = this.dataView[0].color;
            this.$.footer.style.backgroundColor = this.dataView[0].color;
            //set header panel color
            this.$.header.style.backgroundColor = this.headerColor;
            //set title
//            this.$.title.innerText = this.title;
        },

        /**
         * This method fire event to Angular controller and after catch event backing to home
         */
        _home: function () {
            this.fire('home');
        },

        /**
         * Click on next element content and animated to previous page
         */
        _onPrevClick: function () {
            var tempSelect = this.selected === 0 ? this.dataSize : (this.selected - 1);
            this.changeColorsContent(tempSelect);
            this.entryAnimation = 'slide-from-left-animation';
            this.exitAnimation = 'slide-right-animation';
            this.selected = tempSelect;
        },

        /**
         * Click on next element content and animated to next page
         */
        _onNextClick: function () {
            var tempSelect = this.selected === this.dataSize ? 0 : (this.selected + 1);
            this.changeColorsContent(tempSelect);
            this.entryAnimation = 'slide-from-right-animation';
            this.exitAnimation = 'slide-left-animation';
            this.selected = tempSelect;
        },

        /**
         * Set next color to neon-animatable
         * @param select - current number
         */
        changeColorsContent: function (select) {
            var styleContent = document.getElementById(this.dataView[select].id).style;
            if (styleContent == null || styleContent == undefined)
                throw DOMException('Content not yet prepared for modify styles');

            var color = this.dataView[select].color;
            if (color == null || color == undefined)
                color = 'white';

            styleContent.backgroundColor = color;
        }

    })


</script>